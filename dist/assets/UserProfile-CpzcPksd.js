import{s as B}from"./index-e7X01tEO.js";import{s as C}from"./index-BWVrtxJk.js";import{s as I}from"./index-HWYFdEig.js";import{s as N}from"./index-QI8tLig9.js";import{s as S}from"./index-DLuZpoo4.js";import{s as $}from"./index-BS9PyoXu.js";import{d as D,r as p,p as L,o as R,a,b as g,e as l,f as d,u,g as t,j as n,w as j,F as T,s as z}from"./index-BOLqcSEh.js";import{s as f}from"./index-BeWZrEpJ.js";import{U as k}from"./UserService-DRNCzvA6.js";import{P as A}from"./PhotoService-CD1hVyHq.js";import"./index-Nbino4Gd.js";import"./index-De1zXoXx.js";import"./index-DDgVDk_4.js";import"./index-Ck9ebPBA.js";const M={key:0,class:"flex flex-col md:flex-row gap-8"},q={class:"card flex flex-col md:flex-row gap-8 w-full"},G={class:"card flex flex-col items-center"},H={class:"flex flex-col gap-4 w-full"},J={class:"flex flex-col md:flex-row gap-4"},K={class:"flex flex-wrap gap-2 w-full"},O={class:"flex flex-wrap gap-2 w-full"},Q={class:"flex flex-col md:flex-row gap-4"},W={class:"flex flex-wrap gap-2 w-full"},X={class:"flex flex-wrap gap-2 w-full"},Y={class:"flex flex-col md:flex-row gap-4"},Z={class:"flex flex-wrap gap-2 w-full"},ee={class:"flex flex-wrap gap-2 w-full"},le={class:"flex flex-col md:flex-row gap-4"},se={class:"flex flex-wrap gap-2 w-full"},ae={class:"flex flex-wrap gap-2 w-full"},oe={class:"flex flex-col md:flex-row gap-4 mt-8"},te={class:"flex flex-wrap gap-2"},ie={class:"flex flex-col md:flex-row gap-8"},re={class:"card flex flex-col md:flex-row gap-8 w-full"},de={class:"card flex flex-col items-center"},ne={class:"flex justify-center items-center w-64 h-64 rounded-full overflow-hidden"},ue={key:0},fe={class:"card flex flex-col items-center gap-6"},me=["src"],pe={class:"flex flex-col gap-4 w-full"},ce={class:"flex flex-col md:flex-row gap-4"},ve={class:"flex flex-wrap gap-2 w-full"},xe={class:"flex flex-wrap gap-2 w-full"},ge={class:"flex flex-col md:flex-row gap-4"},we={class:"flex flex-wrap gap-2 w-full"},be={class:"flex flex-wrap gap-2 w-full"},_e={class:"flex flex-col md:flex-row gap-4"},ye={class:"flex flex-wrap gap-2 w-full"},he={class:"flex flex-wrap gap-2 w-full"},Ve={class:"flex flex-col md:flex-row gap-4"},ke={class:"flex flex-col gap-2 w-full"},Ue={class:"flex flex-wrap gap-2 w-full"},Pe={class:"flex flex-row gap-4 mt-8"},Ee={class:"flex gap-4"},qe=D({__name:"UserProfile",setup(Fe){const s=p({}),c=p(null),w=p(!1),v=p(!1),i=p(!1),b=p(null),_=L();R(async()=>{try{const r=Number(localStorage.getItem("userId")),e=await k.getUserById(r);s.value=e,w.value=!0}catch(r){console.error(r.response?"Error al obtener al usuario:":"Token no encontrado en localStorage",r)}});const y=()=>{i.value=!i.value},U=async()=>{v.value=!0;try{if(s.value&&c.value){const r=await A.uploadPhoto(c.value);if(r)s.value.photo=r;else{_.add({severity:"error",summary:"Error",detail:"Image upload failed",life:3e3});return}}s.value?(await k.updateUser(s.value),_.add({severity:"success",summary:"Success",detail:"Profile updated successfully",life:3e3})):console.error("User data is null")}catch(r){console.error("Error al actualizar el usuario:",r),_.add({severity:"error",summary:"Error",detail:"Failed to update profile",life:3e3})}finally{v.value=!1,y()}};function P(r){c.value=r.files[0];const e=new FileReader;e.onload=h=>{var x;b.value=(x=h.target)==null?void 0:x.result},c.value&&e.readAsDataURL(c.value)}return(r,e)=>{const h=$,x=S,m=N,E=I,V=C,F=B;return a(),g(T,null,[w.value?t("",!0):(a(),g("div",M,[l("div",q,[l("div",G,[e[8]||(e[8]=l("div",{class:"font-semibold text-2xl mb-4"},"Profile",-1)),d(u(f),{shape:"circle",size:"15rem"})]),l("div",H,[l("div",J,[l("div",K,[e[9]||(e[9]=l("label",{for:"firstname"},"Firstname",-1)),d(u(f),{class:"mb-2",height:"2.5rem"})]),l("div",O,[e[10]||(e[10]=l("label",{for:"lastname"},"Lastname",-1)),d(u(f),{class:"mb-2",height:"2.5rem"})])]),l("div",Q,[l("div",W,[e[11]||(e[11]=l("label",{for:"username"},"Username",-1)),d(u(f),{class:"mb-2",height:"2.5rem"})]),l("div",X,[e[12]||(e[12]=l("label",{for:"email"},"Email",-1)),d(u(f),{class:"mb-2",height:"2.5rem"})])]),l("div",Y,[l("div",Z,[e[13]||(e[13]=l("label",{for:"ruc"},"RUC",-1)),d(u(f),{class:"mb-2",height:"2.5rem"})]),l("div",ee,[e[14]||(e[14]=l("label",{for:"phone"},"Phone",-1)),d(u(f),{class:"mb-2",height:"2.5rem"})])]),l("div",le,[l("div",se,[e[15]||(e[15]=l("label",{for:"birthdate"},"Birthdate",-1)),d(u(f),{class:"mb-2",height:"2.5rem"})]),l("div",ae,[e[16]||(e[16]=l("label",{for:"location"},"Location",-1)),d(u(f),{class:"mb-2",height:"2.5rem"})])]),l("div",oe,[l("div",te,[d(u(f),{width:"10rem",height:"2.5rem"})])])])])])),w.value?(a(),n(F,{key:1},{default:j(()=>[l("div",ie,[l("div",re,[l("div",de,[e[17]||(e[17]=l("div",{class:"font-semibold text-2xl mb-4"},"Profile",-1)),l("div",ne,[s.value?(a(),n(h,{key:0,src:`${u(z)}`+s.value.photo,alt:s.value.user_name,width:"250",height:"250",class:"object-cover"},null,8,["src","alt"])):t("",!0)]),i.value?(a(),g("div",ue,[l("div",fe,[d(x,{mode:"basic",accept:"image/*",onSelect:P,customUpload:"",auto:"",severity:"secondary",class:"p-button-outlined"}),b.value?(a(),g("img",{key:0,src:b.value,alt:"photo",class:"shadow-md rounded-xl w-full sm:w-64"},null,8,me)):t("",!0)])])):t("",!0)]),l("div",pe,[l("div",ce,[l("div",ve,[e[18]||(e[18]=l("label",{for:"firstname"},"Firstname",-1)),s.value?(a(),n(m,{key:0,id:"firstname",type:"text",disabled:!i.value,modelValue:s.value.firstName,"onUpdate:modelValue":e[0]||(e[0]=o=>s.value.firstName=o)},null,8,["disabled","modelValue"])):t("",!0)]),l("div",xe,[e[19]||(e[19]=l("label",{for:"lastname"},"Lastname",-1)),s.value?(a(),n(m,{key:0,id:"lastname",type:"text",disabled:!i.value,modelValue:s.value.lastName,"onUpdate:modelValue":e[1]||(e[1]=o=>s.value.lastName=o)},null,8,["disabled","modelValue"])):t("",!0)])]),l("div",ge,[l("div",we,[e[20]||(e[20]=l("label",{for:"username"},"Username",-1)),s.value?(a(),n(m,{key:0,id:"username",type:"text",disabled:!i.value,modelValue:s.value.user_name,"onUpdate:modelValue":e[2]||(e[2]=o=>s.value.user_name=o)},null,8,["disabled","modelValue"])):t("",!0)]),l("div",be,[e[21]||(e[21]=l("label",{for:"email"},"Email",-1)),s.value?(a(),n(m,{key:0,id:"email",type:"text",disabled:!i.value,modelValue:s.value.email,"onUpdate:modelValue":e[3]||(e[3]=o=>s.value.email=o)},null,8,["disabled","modelValue"])):t("",!0)])]),l("div",_e,[l("div",ye,[e[22]||(e[22]=l("label",{for:"ruc"},"RUC",-1)),s.value?(a(),n(m,{key:0,id:"ruc",type:"text",disabled:!i.value,modelValue:s.value.ruc,"onUpdate:modelValue":e[4]||(e[4]=o=>s.value.ruc=o)},null,8,["disabled","modelValue"])):t("",!0)]),l("div",he,[e[23]||(e[23]=l("label",{for:"phone"},"Phone",-1)),s.value?(a(),n(m,{key:0,id:"phone",type:"text",disabled:!i.value,modelValue:s.value.phone,"onUpdate:modelValue":e[5]||(e[5]=o=>s.value.phone=o)},null,8,["disabled","modelValue"])):t("",!0)])]),l("div",Ve,[l("div",ke,[e[24]||(e[24]=l("label",{for:"birthdate"},"Birthdate",-1)),d(E,{id:"birthdate",modelValue:s.value.birthDate,"onUpdate:modelValue":e[6]||(e[6]=o=>s.value.birthDate=o),disabled:!i.value,showIcon:"",fluid:"",iconDisplay:"input"},null,8,["modelValue","disabled"])]),l("div",Ue,[e[25]||(e[25]=l("label",{for:"location"},"Location",-1)),s.value?(a(),n(m,{key:0,id:"location",type:"text",disabled:!i.value,modelValue:s.value.location,"onUpdate:modelValue":e[7]||(e[7]=o=>s.value.location=o)},null,8,["disabled","modelValue"])):t("",!0)])]),l("div",Pe,[l("div",Ee,[i.value?t("",!0):(a(),n(V,{key:0,type:"button",class:"mr-2 mb-2",label:"Edit Information",icon:"pi pi-pencil",iconPos:"left",loading:v.value,onClick:y},null,8,["loading"])),i.value?(a(),n(V,{key:1,type:"button",class:"mr-2 mb-2 whitespace-nowrap",label:"Save",icon:"pi pi-save",iconPos:"left",loading:v.value,onClick:U},null,8,["loading"])):t("",!0),i.value?(a(),n(V,{key:2,type:"button",class:"mr-2 mb-2 whitespace-nowrap",severity:"danger",label:"Cancel",icon:"pi pi-times",iconPos:"left",loading:v.value,onClick:y},null,8,["loading"])):t("",!0)])])])])])]),_:1})):t("",!0)],64)}}});export{qe as default};
