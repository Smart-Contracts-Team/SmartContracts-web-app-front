import{s as F,a as B}from"./index-CvRR4B1I.js";import{s as C}from"./index-BQ82LSVU.js";import{s as I}from"./index-BeosiNou.js";import{s as N}from"./index-7q-KOIMy.js";import{d as S,r as p,j as $,o as L,a as s,c as w,b as l,e as n,u,i as o,g as r,w as R,F as D,s as j}from"./index-o2anLdNF.js";import{s as f}from"./index-D2WTH_3Y.js";import{U}from"./UserService-CUGCGzV2.js";import{P as T}from"./PhotoService-Cjq5erfy.js";import"./index-HN1c8puf.js";import"./index-DJyijS95.js";import"./index-BtL0hmx1.js";const z={key:0,class:"flex flex-col md:flex-row gap-8"},A={class:"card flex flex-col md:flex-row gap-8 w-full"},M={class:"card flex flex-col items-center"},W={class:"flex flex-col gap-4 w-full"},q={class:"flex flex-col md:flex-row gap-4"},G={class:"flex flex-wrap gap-2 w-full"},H={class:"flex flex-wrap gap-2 w-full"},J={class:"flex flex-col md:flex-row gap-4"},K={class:"flex flex-wrap gap-2 w-full"},O={class:"flex flex-wrap gap-2 w-full"},Q={class:"flex flex-col md:flex-row gap-4"},X={class:"flex flex-wrap gap-2 w-full"},Y={class:"flex flex-wrap gap-2 w-full"},Z={class:"flex flex-col md:flex-row gap-4"},ee={class:"flex flex-wrap gap-2 w-full"},le={class:"flex flex-wrap gap-2 w-full"},ae={class:"flex flex-col md:flex-row gap-4 mt-8"},se={class:"flex flex-wrap gap-2"},oe={class:"flex flex-col md:flex-row gap-8"},te={class:"card flex flex-col md:flex-row gap-8 w-full"},ie={class:"card flex flex-col items-center"},re={class:"flex justify-center items-center w-64 h-64 rounded-full overflow-hidden"},de={key:0},ne={class:"card flex flex-col items-center gap-6"},ue=["src"],fe={class:"flex flex-col gap-4 w-full"},me={class:"flex flex-col md:flex-row gap-4"},pe={class:"flex flex-wrap gap-2 w-full"},ce={class:"flex flex-wrap gap-2 w-full"},ve={class:"flex flex-col md:flex-row gap-4"},xe={class:"flex flex-wrap gap-2 w-full"},ge={class:"flex flex-wrap gap-2 w-full"},we={class:"flex flex-col md:flex-row gap-4"},be={class:"flex flex-wrap gap-2 w-full"},_e={class:"flex flex-wrap gap-2 w-full"},ye={class:"flex flex-col md:flex-row gap-4"},he={class:"flex flex-wrap gap-2 w-full"},Ve={class:"flex flex-wrap gap-2 w-full"},Ue={class:"flex flex-row gap-4 mt-8"},ke={class:"flex gap-4"},je=S({__name:"UserProfile",setup(Pe){const a=p(),c=p(null),b=p(!1),v=p(!1),i=p(!1),_=p(null),x=$();L(async()=>{try{const d=Number(localStorage.getItem("userId")),e=await U.getUserById(d);a.value=e,b.value=!0}catch(d){console.error(d.response?"Error al obtener al usuario:":"Token no encontrado en localStorage",d)}});const y=()=>{i.value=!i.value},k=async()=>{v.value=!0;try{if(a.value&&c.value){const d=await T.uploadPhoto(c.value);if(d)a.value.photo=d;else{x.add({severity:"error",summary:"Error",detail:"Image upload failed",life:3e3});return}}else{x.add({severity:"warn",summary:"Warning",detail:"User data or selected file is missing.",life:3e3});return}a.value?(await U.updateUser(a.value),x.add({severity:"success",summary:"Success",detail:"Profile updated successfully",life:3e3})):console.error("User data is null")}catch(d){console.error("Error al actualizar el usuario:",d),x.add({severity:"error",summary:"Error",detail:"Failed to update profile",life:3e3})}finally{v.value=!1,y()}};function P(d){c.value=d.files[0];const e=new FileReader;e.onload=h=>{var g;_.value=(g=h.target)==null?void 0:g.result},c.value&&e.readAsDataURL(c.value)}return(d,e)=>{const h=B,g=N,m=I,V=C,E=F;return s(),w(D,null,[b.value?o("",!0):(s(),w("div",z,[l("div",A,[l("div",M,[e[8]||(e[8]=l("div",{class:"font-semibold text-2xl mb-4"},"Profile",-1)),n(u(f),{shape:"circle",size:"15rem"})]),l("div",W,[l("div",q,[l("div",G,[e[9]||(e[9]=l("label",{for:"firstname"},"Firstname",-1)),n(u(f),{class:"mb-2",height:"2.5rem"})]),l("div",H,[e[10]||(e[10]=l("label",{for:"lastname"},"Lastname",-1)),n(u(f),{class:"mb-2",height:"2.5rem"})])]),l("div",J,[l("div",K,[e[11]||(e[11]=l("label",{for:"username"},"Username",-1)),n(u(f),{class:"mb-2",height:"2.5rem"})]),l("div",O,[e[12]||(e[12]=l("label",{for:"email"},"Email",-1)),n(u(f),{class:"mb-2",height:"2.5rem"})])]),l("div",Q,[l("div",X,[e[13]||(e[13]=l("label",{for:"ruc"},"RUC",-1)),n(u(f),{class:"mb-2",height:"2.5rem"})]),l("div",Y,[e[14]||(e[14]=l("label",{for:"phone"},"Phone",-1)),n(u(f),{class:"mb-2",height:"2.5rem"})])]),l("div",Z,[l("div",ee,[e[15]||(e[15]=l("label",{for:"birthdate"},"Birthdate",-1)),n(u(f),{class:"mb-2",height:"2.5rem"})]),l("div",le,[e[16]||(e[16]=l("label",{for:"location"},"Location",-1)),n(u(f),{class:"mb-2",height:"2.5rem"})])]),l("div",ae,[l("div",se,[n(u(f),{width:"10rem",height:"2.5rem"})])])])])])),b.value?(s(),r(E,{key:1},{default:R(()=>[l("div",oe,[l("div",te,[l("div",ie,[e[17]||(e[17]=l("div",{class:"font-semibold text-2xl mb-4"},"Profile",-1)),l("div",re,[a.value?(s(),r(h,{key:0,src:`${u(j)}`+a.value.photo,alt:"Image",width:"250",height:"250",class:"object-cover"},null,8,["src"])):o("",!0)]),i.value?(s(),w("div",de,[l("div",ne,[n(g,{mode:"basic",accept:"image/*",onSelect:P,customUpload:"",auto:"",severity:"secondary",class:"p-button-outlined"}),_.value?(s(),w("img",{key:0,src:_.value,alt:"photo",class:"shadow-md rounded-xl w-full sm:w-64"},null,8,ue)):o("",!0)])])):o("",!0)]),l("div",fe,[l("div",me,[l("div",pe,[e[18]||(e[18]=l("label",{for:"firstname"},"Firstname",-1)),a.value?(s(),r(m,{key:0,id:"firstname",type:"text",disabled:!i.value,modelValue:a.value.firstName,"onUpdate:modelValue":e[0]||(e[0]=t=>a.value.firstName=t)},null,8,["disabled","modelValue"])):o("",!0)]),l("div",ce,[e[19]||(e[19]=l("label",{for:"lastname"},"Lastname",-1)),a.value?(s(),r(m,{key:0,id:"lastname",type:"text",disabled:!i.value,modelValue:a.value.lastName,"onUpdate:modelValue":e[1]||(e[1]=t=>a.value.lastName=t)},null,8,["disabled","modelValue"])):o("",!0)])]),l("div",ve,[l("div",xe,[e[20]||(e[20]=l("label",{for:"username"},"Username",-1)),a.value?(s(),r(m,{key:0,id:"username",type:"text",disabled:!i.value,modelValue:a.value.user_name,"onUpdate:modelValue":e[2]||(e[2]=t=>a.value.user_name=t)},null,8,["disabled","modelValue"])):o("",!0)]),l("div",ge,[e[21]||(e[21]=l("label",{for:"email"},"Email",-1)),a.value?(s(),r(m,{key:0,id:"email",type:"text",disabled:!i.value,modelValue:a.value.email,"onUpdate:modelValue":e[3]||(e[3]=t=>a.value.email=t)},null,8,["disabled","modelValue"])):o("",!0)])]),l("div",we,[l("div",be,[e[22]||(e[22]=l("label",{for:"ruc"},"RUC",-1)),a.value?(s(),r(m,{key:0,id:"ruc",type:"text",disabled:!i.value,modelValue:a.value.ruc,"onUpdate:modelValue":e[4]||(e[4]=t=>a.value.ruc=t)},null,8,["disabled","modelValue"])):o("",!0)]),l("div",_e,[e[23]||(e[23]=l("label",{for:"phone"},"Phone",-1)),a.value?(s(),r(m,{key:0,id:"phone",type:"text",disabled:!i.value,modelValue:a.value.phone,"onUpdate:modelValue":e[5]||(e[5]=t=>a.value.phone=t)},null,8,["disabled","modelValue"])):o("",!0)])]),l("div",ye,[l("div",he,[e[24]||(e[24]=l("label",{for:"birthdate"},"Birthdate",-1)),a.value?(s(),r(m,{key:0,id:"birthdate",type:"text",disabled:!i.value,modelValue:a.value.birthDate,"onUpdate:modelValue":e[6]||(e[6]=t=>a.value.birthDate=t)},null,8,["disabled","modelValue"])):o("",!0)]),l("div",Ve,[e[25]||(e[25]=l("label",{for:"location"},"Location",-1)),a.value?(s(),r(m,{key:0,id:"location",type:"text",disabled:!i.value,modelValue:a.value.location,"onUpdate:modelValue":e[7]||(e[7]=t=>a.value.location=t)},null,8,["disabled","modelValue"])):o("",!0)])]),l("div",Ue,[l("div",ke,[i.value?o("",!0):(s(),r(V,{key:0,type:"button",class:"mr-2 mb-2",label:"Edit Information",icon:"pi pi-pencil",iconPos:"left",loading:v.value,onClick:y},null,8,["loading"])),i.value?(s(),r(V,{key:1,type:"button",class:"mr-2 mb-2 whitespace-nowrap",label:"Save",icon:"pi pi-save",iconPos:"left",loading:v.value,onClick:k},null,8,["loading"])):o("",!0),i.value?(s(),r(V,{key:2,type:"button",class:"mr-2 mb-2 whitespace-nowrap",severity:"danger",label:"Cancel",icon:"pi pi-times",iconPos:"left",loading:v.value,onClick:y},null,8,["loading"])):o("",!0)])])])])])]),_:1})):o("",!0)],64)}}});export{je as default};
